{
    "name": "cybereason",
    "version": "1.0.0",
    "label": "Cybereason",
    "description": "The Cybereason Defense Platform combines endpoint prevention, detection, and response all in one lightweight agent",
    "publisher": "Community",
    "icon_small_name": "small_icon.png",
    "icon_large_name": "large_icon.png",
    "id": 126,
    "configuration":
    {
        "fields":
        [
            {
                "title": "Server URL",
                "name": "server",
                "description": "Cybereason Server IP",
                "required": true,
                "editable": true,
                "visible": true,
                "value": "",
                "placeholder": "https://192.168.123.12",
                "type": "text"
            },
            {
                "title": "Username",
                "name": "username",
                "description": "Cybereason Username",
                "required": true,
                "editable": true,
                "visible": true,
                "value": "",
                "type": "text"
            },
            {
                "title": "Password",
                "name": "password",
                "description": "Cybereason Password",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "password"
            },
            {
                "title": "Verify SSL",
                "name": "verify_ssl",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "checkbox"
            }
        ]
    },
    "operations":
    [
        {
            "operation": "get_sensors",
            "title": "Query Sensors",
            "description": "Sends a request to return details on all or a selected group of sensors",
            "category": "investigation",
            "annotation": "get_sensors",
            "output_schema":
            {},
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Limit",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "integer",
                    "name": "limit",
                    "tooltip": "The number of returned items per page; set to 0 to get available data altogether (used for pagination)",
                    "value": 50,
                    "description": "The number of returned items per page; set to 0 to get available data altogether (used for pagination)"
                },
                {
                    "title": "Offset",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "integer",
                    "name": "offset",
                    "value": 0,
                    "tooltip": "The offset of the first item to return. Default: 0 Min: 0",
                    "description": "Index of the first item to return. Values supported are: Default: 0 Min: 0"
                },
                {
                    "title": "Sort Direction",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "select",
                    "options":
                    [
                        "ASC",
                        "DESC"
                    ],
                    "name": "sortDirection",
                    "value": "ASC",
                    "tooltip": "The order in which to receive results. Valid values are ASC (ascending) or DESC (descending)."
                },
                {
                    "title": "Machine Name",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.machineName",
                    "value": "",
                    "description": "Filter by machine name"
                },
                {
                    "title": "Machine GUID",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.guid",
                    "value": "",
                    "description": "Filter by the The globally unique sensor identifier"
                },
                {
                    "title": "External IP Address",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.externalIpAddress",
                    "value": "",
                    "description": "Filter by the WAN IP address of the machine"
                },
                {
                    "title": "Internal IP Address",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.internalIpAddress",
                    "value": "",
                    "description": "Filter by the LAN IP address of the machine"
                },
                                {
                    "title": "Custom Tags",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.customTags",
                    "value": "",
                    "description": "Filter by a list of custom sensor tags assigned to the machine"
                },
                {
                    "title": "Department",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "filter.department",
                    "value": "",
                    "description": "Filter by the value assigned to the machine for the DEPARTMENT sensor tag"
                },
                {
                    "title": "Custom Filters",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "raw_filters",
                    "placeholder": "{\"fieldName\":\"osType\",\"operator\":\"Equals\",\"values\":[\"WINDOWS\",\"LINUX\"]}",
                    "description": "A comma separated list of filters, check documentation at https://nest.cybereason.com/documentation/api-documentation/all-versions/query-sensors"
                }
            ]
        },
        {
            "operation": "get_malops",
            "title": "Get Incidents",
            "description": "Returns details about all Auto Hunt Malops and Endpoint Protection Malops (version:20.1.43+)",
            "category": "investigation",
            "annotation": "get_malops",
            "output_schema":
            {},
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Start Time",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "datetime",
                    "name": "start_time",
                    "tooltip": "Time of the oldest data you want to get"
                },
                {
                    "title": "End Time",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "datetime",
                    "name": "end_time",
                    "tooltip": "Time of the most recent data you want to get"
                }
            ]
        },
        {
            "operation": "query_user",
            "title": "Query User",
            "description": "Get user details",
            "annotation": "query_user",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Username",
                    "description": "Username to search for",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.username"
                }
            ],
            "category": "investigation",
            "output_schema":
            {}
        },
        {
            "operation": "query_file",
            "title": "Query File by its Hash",
            "description": "Search for a file by its hash code",
            "annotation": "query_file",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "File Hash",
                    "description": "File hash, md5 or sha1",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.filehash"
                }
            ],
            "category": "investigation",
            "output_schema":
            {}
        },
        {
            "operation": "query_process",
            "title": "Get Process On Endpoint",
            "description": "Search for a process",
            "annotation": "query_processes",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Process Name",
                    "description": "Process Name",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.elementDisplayName"
                },
                {
                    "title": "User",
                    "description": "Filter by User",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.calculatedUser"
                },
                {
                    "title": "Executed By",
                    "description": "The name of the process executing this process",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.execedBy"
                },
                {
                    "title": "Machine Owner",
                    "description": "Name of the owner machine for this process",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.ownerMachine"
                },
                {
                    "title": "Parent Process",
                    "description": "The parent process of this process",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "name": "filter.parentProcess"
                },
                {
                    "title": "Has Outgoing Connection",
                    "description": "Filter by processes with outgoing connections",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "checkbox",
                    "name": "filter.hasOutgoingConnection"
                },
                {
                    "title": "From Temporary Folder",
                    "description": "Filter by processes running from temporary folder",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "checkbox",
                    "name": "filter.hasModuleFromTempEvidence"
                },
                                {
                    "title": "Custom Filters",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "raw_filters",
                    "placeholder": "{\"facetName\": \"hasOutgoingConnection\", \"values\": [true]}",
                    "description": "A comma separated list of filters, check documentation at https://nest.cybereason.com/documentation/api-documentation/all-versions/query-elements-and-features"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "isolate_sensor_by_pylum_id",
            "title": "Isolate Malop Machine by Pylum ID",
            "description": "Isolates a machine or machines involved in a specific Malop",
            "annotation": "isolate_sensor_by_pylum_id",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Pylum ID(s)",
                    "description": "The unique sensor ID the Cybereason platform uses for the machines to isolate",
                    "tooltip": "If you are entering multiple values, add a comma between each sensor ID",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "placeholder": "PylumID 1,PylumID 2,PylumID 3...",
                    "type": "text",
                    "name": "pylumIds"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "unisolate_sensor_by_pylum_id",
            "title": "Un-Isolate Malop Machine by Pylum ID",
            "description": "Un-Isolates a machine or machines involved in a specific Malop",
            "annotation": "unisolate_sensor_by_pylum_id",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Pylum ID(s)",
                    "description": "The unique sensor ID the Cybereason platform uses for the machines to un-isolate",
                    "tooltip": "If you are entering multiple values, add a comma between each sensor ID",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "placeholder": "PylumID 1,PylumID 2,PylumID 3...",
                    "type": "text",
                    "name": "pylumIds"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "isolate_sensor_by_ip",
            "title": "Isolate Malop Machine by IP Address",
            "description": "Isolates a machine via its IP Address",
            "annotation": "isolate_sensor_by_ip",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Internal IP Address",
                    "description": "Internal IP Address of the sensor to block",
                    "tooltip": "If you are entering multiple values, add a comma between each IP",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "placeholder": "10.1.1.1,192.168.10.10,172.16.1.30...",
                    "type": "text",
                    "name": "ip_addresses"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "unisolate_sensor_by_ip",
            "title": "Un-Isolate Malop Machine by IP Address",
            "description": "Un-Isolates a machine via its IP Address",
            "annotation": "unisolate_sensor_by_ip",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Internal IP Address",
                    "description": "Internal IP Address of the sensor to un-isolate",
                    "tooltip": "If you are entering multiple values, add a comma between each IP",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "placeholder": "10.1.1.1,192.168.10.10,172.16.1.30...",
                    "type": "text",
                    "name": "ip_addresses"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "kill_process",
            "title": "Kill Process On Endpoint",
            "description": "Kill Process",
            "annotation": "kill_process",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "Process GUID",
                    "description": "Process ID",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "tooltip": "You can get it with Query Process action",
                    "name": "process_guid"
                },
                {
                    "title": "Machine GUID",
                    "description": "GUID of the machine on which to kill the process",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "tooltip": "You can get it with Query Process action",
                    "name": "machine_guid"
                }
            ],
            "category": "remediation",
            "output_schema":
            {}
        },
        {
            "operation": "blacklist_file",
            "title": "Blacklist File",
            "description": "Organization wide file(s) hash(es) blacklist",
            "annotation": "blacklist_file",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "File Hash",
                    "description": "A single MD5/SHA1 or a CSV list are accepted",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "placeholder": "0aae5873aa0e9f80d3fa41524bef6825723b9e87,14e25873aa0e9f80d3fa41524bef6825723bwe45",
                    "name": "keys"
                },
                {
                   "title":"Remove From List",
                   "required":false,
                   "editable":true,
                   "visible":true,
                   "type":"checkbox",
                   "name":"remove",
                   "value": false,
                   "tooltip":"The default action is Add to list, if this is checked the items will be removed instead",
                   "description":"Removes the above item(s) from the Blacklist"
                },
                {
                    "title": "Prevent Execution",
                    "description": "Indicates whether to prevent the fileâ€™s execution with Application Control",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "type": "checkbox",
                    "value": false,
                    "tooltip": "This parameter will be ignored if Remove From List is Set",
                    "name": "prevent"
                }
            ],
            "category": "remediation",
            "output_schema":{}
        },
        {
            "operation": "whitelist_file",
            "title": "Whitelist File",
            "description": "Organization wide file(s) hash(es) whitelist",
            "annotation": "whitelist_file",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "File Hash",
                    "description": "A single MD5/SHA1 or a CSV list are accepted",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "placeholder": "0aae5873aa0e9f80d3fa41524bef6825723b9e87,14e25873aa0e9f80d3fa41524bef6825723bwe45",
                    "name": "keys"
                },
                {
                   "title":"Remove From List",
                   "required":false,
                   "editable":true,
                   "visible":true,
                   "type":"checkbox",
                   "name":"remove",
                   "value": false,
                   "tooltip":"The default action is Add to list, if this is checked the items will be removed instead",
                   "description":"Removes the above item(s) from the Whitelist"
                }
            ],
            "category": "remediation",
            "output_schema":{}
        },
        {
            "operation": "blacklist_ip_or_domain",
            "title": "Blacklist IP or Domain",
            "description": "Organization wide IP(s) and/or Domain(s) blacklist",
            "annotation": "blacklist_ip_or_domain",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "IPs or Domains",
                    "description": "A single IP/Domain or a CSV list them",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "placeholder": "10.20.1.1,mydomain.com",
                    "name": "keys"
                },
                {
                   "title":"Remove From List",
                   "required":false,
                   "editable":true,
                   "visible":true,
                   "type":"checkbox",
                   "name":"remove",
                   "value": false,
                   "tooltip":"The default action is Add to list, if this is checked the items will be removed instead",
                   "description":"Removes the above item(s) from the Blacklist"
                }
            ],
            "category": "remediation",
            "output_schema":{}
        },
        {
            "operation": "whitelist_ip_or_domain",
            "title": "Whitelist IP or Domain",
            "description": "Organization wide IP(s) and/or Domain(s) whitelist",
            "annotation": "whitelist_ip_or_domain",
            "enabled": true,
            "parameters":
            [
                {
                    "title": "IPs or Domains",
                    "description": "A single IP/Domain or a CSV list them",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "type": "text",
                    "placeholder": "10.20.1.1,mydomain.com",
                    "name": "keys"
                },
                {
                   "title":"Remove From List",
                   "required":false,
                   "editable":true,
                   "visible":true,
                   "type":"checkbox",
                   "name":"remove",
                   "value": false,
                   "tooltip":"The default action is Add to list, if this is checked the items will be removed instead",
                   "description":"Removes the above item(s) from the Whitelist"
                }
            ],
            "category": "remediation",
            "output_schema":{}
        }
    ],
    "category": "endpoint",
    "active": true,
    "cs_compatible": true,
    "system": false,
    "help_online": "https://docs.fortinet.com/document/cybereason/1.0.0/cybereason"
}